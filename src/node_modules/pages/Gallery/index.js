import React, { useEffect, useState } from 'react';
import { connect } from 'react-redux';

import { fetchGalleryPhotos } from 'actions/gallery';

import './gallery.scss';

function Gallery({ fetchGalleryPhotos, isFetching, photos, errors }) {

    const [page, usePage] = useState(1);
    const [prevY, usePrevY] = useState(1);

    useEffect(() => { fetchGalleryPhotos(page) }, [fetchGalleryPhotos, page]);

    return (
        <main className="main">
            <div className="container">
                <article className="gallery">
                    <h1>Галерея</h1>
                    {isFetching && (<p>Loading...</p>)}
                    {errors && (<p>Error</p>)}
                    <div className="photos">
                        {!isFetching && !errors && photos.map((photo) => (
                            <Figure key={photo.id} {...photo} />
                        ))}
                    </div>
                </article>
            </div>
        </main>
    );
}

const mapStateToProps = (state) => ({
    photos: state.gallery.photos,
    isFetching: state.gallery.isFetching,
    errors: state.gallery.errors,
});

const mapDispatchToProps = {
    fetchGalleryPhotos
};

export default connect(mapStateToProps, mapDispatchToProps)(Gallery);

function Figure({ albumId, id, title, url, thumbnailUrl }) {

    return (
        <figure className="photo">
            <img src={url} alt={title} />
            <figcaption>{title}</figcaption>
        </figure>
    );
}