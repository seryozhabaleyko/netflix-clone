import React, { useEffect } from 'react';
import { connect } from 'react-redux';

import { fetchCourses, fetchCoursesCategories } from 'actions/courses';
import Course from './components/Course';
import Category from './components/Category';

import { LoaderPopular, LoaderCategories } from './components/Loader';

import './courses.scss';

function Courses({ fetchCourses, fetchCoursesCategories, isFetching, courses, categories, error }) {

    useEffect(() => { fetchCourses() }, [fetchCourses]);
    useEffect(() => { fetchCoursesCategories() }, [fetchCoursesCategories]);

    return (
        <main className="main">
            <div className="container">
                <section className="courses">
                    {/* <h1>Курсы</h1> */}
                    {/* <CoursesPopular /> */}
                    <section className="courses-popular">
                        <div className="popular-heading">
                            <h2>Популярные курсы</h2>
                            <p>Нет никого, кто любил бы боль саму по себе, кто искал бы её и кто хотел бы иметь её просто потому, что это боль..</p>
                            <a href="/courses/popular" className="all">
                                Посмотреть все
                                <span className="material-icons">chevron_right</span>
                            </a>
                        </div>
                        <ul className="popular-list">
                            {error.courses && (<p>Error</p>)}
                            {isFetching.courses && <LoaderPopular />}
                            {!isFetching.courses && !error.courses && courses.map((course) => (
                                <li key={course.id}>
                                    <Course {...course} />
                                </li>
                            ))}
                        </ul>
                    </section>

                    {/* <CoursesCategories /> */}
                    <section className="courses-categories">
                        <div className="categories-heading">
                            <h2>Категории</h2>
                            <p>Найти курс, просматривая топ категории</p>
                        </div>
                        <ul className="categories-list">
                            {error.categories && (<p>Error</p>)}
                            {isFetching.categories && <LoaderCategories />}
                            {!isFetching.categories && !error.categories && categories.map((category) => (
                                <li key={category.id}>
                                    <Category {...category} />
                                </li>
                            ))}
                        </ul>
                    </section>

                    <section className="courses-new">
                        <div className="new-heading">
                            <h2>Новые курсы</h2>
                            <p>Нет никого, кто любил бы боль саму по себе, кто искал бы её и кто хотел бы иметь её просто потому, что это боль..</p>
                        </div>
                        <ul className="new-list">
                            {error.courses && (<p>Error</p>)}
                            {isFetching.courses && (<p>Loading...</p>)}
                            {!isFetching.courses && !error.courses && courses.map((course) => (
                                <li key={course.id}>
                                    <Course {...course} />
                                </li>
                            ))}
                        </ul>
                    </section>

                    <section className="courses-new">
                        <div className="new-heading">
                            <h2>Все курсы</h2>
                            <p>Нет никого, кто любил бы боль саму по себе, кто искал бы её и кто хотел бы иметь её просто потому, что это боль..</p>
                        </div>
                        <ul className="new-list">
                            {error.courses && (<p>Error</p>)}
                            {isFetching.courses && (<p>Loading...</p>)}
                            {!isFetching.courses && !error.courses && courses.map((course) => (
                                <li key={course.id}>
                                    <Course {...course} />
                                </li>
                            ))}
                        </ul>
                    </section>

                    <div className="course-list">
                        {error.courses && (<p>Error</p>)}
                        {isFetching.courses && (<p>Loading...</p>)}
                        {!isFetching.courses && !error.courses && courses.map((course) => (
                            <Course key={course.id} {...course} />
                        ))}
                    </div>
                </section>
            </div>
        </main>
    );
}

const mapStatetoProps = (state) => ({
    isFetching: { courses: state.courses.isFetching, categories: state.coursesCategories.isFetching },
    courses: state.courses.courses,
    categories: state.coursesCategories.categories,
    error: { courses: state.courses.error, categories: state.coursesCategories.error },
});

const mapDispatchToProps = {
    fetchCourses,
    fetchCoursesCategories,
};

export default connect(mapStatetoProps, mapDispatchToProps)(Courses);