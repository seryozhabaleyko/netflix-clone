import React, { useEffect } from 'react';
import { connect } from 'react-redux';

import Container from 'components/Container';
import { fetchCourses } from 'actions/courses';

function Courses({ fetchCourses, isFetching, courses, error }) {

    useEffect(() => { fetchCourses() }, [fetchCourses]);

    return (
        <main className="main">
            <Container>
                <div className="courses">
                    <h1>Курсы</h1>
                    <div>
                        {error && (<p>Error</p>)}
                        {isFetching && (<p>Loading...</p>)}
                        {!isFetching && !error && courses.map((course) => (
                            <Course key={course.id} {...course} />
                        ))}
                    </div>
                </div>
            </Container>
        </main>
    );
}

const mapStatetoProps = (state) => ({
    isFetching: state.courses.isFetching,
    courses: state.courses.data,
    error: state.courses.error,
});

const mapDispatchToProps = {
    fetchCourses,
};

export default connect(mapStatetoProps, mapDispatchToProps)(Courses);

function Course({ title = '', image = 'https://via.placeholder.com/250x150' }) {

    return (
        <article className="course">
            <figure>
                <img src={image} alt={title} />
            </figure>
            <h2>{title}</h2>
        </article>
    );
}