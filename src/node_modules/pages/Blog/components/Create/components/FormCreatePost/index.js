import React, { useState } from 'react';
import { compose } from 'recompose';

import { withFirebase } from 'components/firebase';

function FormCreatePost({ firebase }) {

    const [title, setTitle] = useState('');
    const [description, setDescription] = useState('');
    const [tagList, setTagList] = useState('');
    const [loading, setLoading] = useState(false);

    const onSubmit = (event) => {
        event.preventDefault();

        setLoading(true);

        firebase.doCreatePost()
            .set({
                title,
                description,
                tagList,
            });

        // setLoading(false);
    };

    const isInvalid = title === '' || description === '' || tagList === '';

    return (
        <form className="" onSubmit={onSubmit}>
            <div>
                <label htmlFor="title">title</label>
                <input
                    id="title"
                    type="text"
                    placeholder="title"
                    value={title}
                    onChange={(event) => setTitle(event.target.value)}
                />
            </div>
            <div>
                <label htmlFor="description">description</label>
                <textarea
                    id="description"
                    type="text"
                    rows="8"
                    placeholder="description"
                    value={description}
                    onChange={(event) => setDescription(event.target.value)}
                />
            </div>
            <div>
                <label htmlFor="tagList">Tag list</label>
                <input
                    id="tagList"
                    type="text"
                    placeholder="tag list"
                    value={tagList}
                    onChange={(event) => setTagList(event.target.value)}
                />
            </div>
            <div>
                <button
                    className="button success"
                    type="submit"
                    disabled={isInvalid}
                >
                    Опубликовать
                </button>
                {loading && (<div>Loading...</div>)}
            </div>
        </form>
    );
}

export default compose(withFirebase)(FormCreatePost);