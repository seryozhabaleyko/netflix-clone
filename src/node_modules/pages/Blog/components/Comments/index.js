import React, { useEffect } from 'react';
import { connect } from 'react-redux';

import { fetchBlogArticleComments } from 'actions/blog';
import Comment from './components/Comment';

import './comments.scss';

function Comments({ match, fetchBlogArticleComments, comments, isFetching, error }) {

    const { slug } = match.params;

    console.log(slug);

    useEffect(() => {



        fetchBlogArticleComments(1); // postId
    }, [match, fetchBlogArticleComments]);

    return (
        <div className="comments">
            <h3>
                Комментарии{" "}
                <span className="comments-amount">
                    {!isFetching && !error && (comments.length)}
                </span>
            </h3>
            {isFetching && (<p>Loading post...</p>)}
            {error && (<p>Unable to display post.</p>)}
            {!isFetching && !error && (
                <ul>
                    {comments.map((comment) => (
                        <Comment key={comment.id} {...comment} />
                    ))}
                </ul>
            )}
        </div>
    );
}

const mapStateToProps = (state) => ({
    comments: state.blogArticleComments.comments,
    isFetching: state.blogArticleComments.isFetching,
    error: state.blogArticleComments.error,
});

const mapDispatchToProps = {
    fetchBlogArticleComments,
};

export default connect(mapStateToProps, mapDispatchToProps)(Comments);