import React, { useEffect } from 'react';
import { Link } from 'react-router-dom';
import { connect } from 'react-redux';

import { fetchBooks } from 'actions/books';

import './books.scss';

function Books({ fetchBooks, isFetching, books, error }) {

    useEffect(() => { fetchBooks(); }, [fetchBooks]);

    return (
        <main className="main">
            <div className="container">
                <section className="books">
                    {/* <h1>Книги</h1> */}
                    <section className="books-popular">
                        <div className="books-heading">
                            <h2>Популярные книги</h2>
                            <p>Нет никого, кто любил бы боль саму по себе, кто искал бы её и кто хотел бы иметь..</p>
                            <a href="/courses/popular" className="all">
                                Посмотреть все
                                <span className="material-icons">chevron_right</span>
                            </a>
                        </div>
                        <div className="popular-list">
                            {isFetching && (<p>Loading..</p>)}
                            {error && (<p>Error</p>)}
                            {!isFetching && !error && books.map((book) => (
                                <Book key={book.id} {...book} />
                            ))}
                        </div>
                    </section>
                </section>
            </div>
        </main>
    );
}

const mapStateToProps = (state) => ({
    isFetching: state.books.isFetching,
    books: state.books.books,
    error: state.books.error,
});

const mapDispatchToProps = {
    fetchBooks,
};

export default connect(mapStateToProps, mapDispatchToProps)(Books);

function Book({ id = 1, title = '', author = [] }) {

    return (
        <Link to={`/book/${id}`}>
            <figure>
                <img src="" alt="" />
                <figcaption>{title}</figcaption>
            </figure>
        </Link>
    );
}