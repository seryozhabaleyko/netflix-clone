import React, { useEffect } from 'react';
import { connect } from 'react-redux';

import { fetchUsers, follow, unfollow } from 'actions/users';

import './users.scss';

function Users({ fetchUsers, isFetching, users = [], error }) {

    useEffect(() => { fetchUsers(1); }, [fetchUsers]);

    return (
        <main className="main">
            <div className="container">
                <section className="users">
                    {/* <h1>User</h1> */}
                    <div className="users-list">
                        {isFetching && (<p>Loading..</p>)}
                        {!isFetching && !error && users.map((user) => (
                            <User key={user.id} {...user} />
                        ))}
                    </div>
                </section>
            </div>
        </main>
    );
}

const mstp = (state) => ({
    isFetching: state.users.isFetching,
    users: state.users.users.data,
    error: state.users.error,
});

const mdtp = {
    fetchUsers,
    follow,
    unfollow,
};

export default connect(mstp, mdtp)(Users);

function User({ id, email, first_name, last_name, avatar }) {

    const fullName = `${first_name} ${last_name}`;

    return (
        <div className="user">
            <div className="user-avatar">
                <img src={avatar} alt={fullName} />
                <span className="online"></span>
            </div>
            <div className="user-body">
                <h3>{fullName}</h3>
                <p>{email}</p>
                <div>
                    <button className="button primary small" type="button">Add</button>
                    <button className="button secondary small" type="button">Remove </button>
                </div>
            </div>
        </div>
    );
}