import React, { Suspense, Fragment, lazy } from 'react';
import { BrowserRouter as Router, Switch, Route } from 'react-router-dom';

import AdminPage from 'components/admin';
import { withAuthentication } from 'components/Session';
import Navbar from 'components/Navbar';

import './index.scss';

const User = lazy(() => import('pages/User'))
const Home = lazy(() => import('pages/Home'));
const Blog = lazy(() => import('pages/Blog'));
const BlogSingle = lazy(() => import('pages/Blog/components/Single'));
const Gallery = lazy(() => import('pages/Gallery'));
const Courses = lazy(() => import('pages/Courses'));

function App() {

    return (
        <Router>
            <Fragment>
                <Navbar />
                <Suspense fallback={<div>Загрузка...</div>}>
                    <Switch>
                        <Route path="/" component={Home} exact />

                        <Route path="/user" component={User} />
                        <Route path="/user/:username" component={User} />

                        <Route path="/blog" component={Blog} exact />
                        <Route path="/blog/new" component={Blog} />
                        <Route path="/blog/:slug" component={BlogSingle} />
                        <Route path="/blog/:slug/edit" component={Blog} />

                        <Route path="/gallery" component={Gallery} />

                        <Route path="/courses" component={Courses} />

                        <Route path="/admin" component={AdminPage} />
                    </Switch>
                </Suspense>
            </Fragment>
        </Router>
    );
};

export default withAuthentication(App);